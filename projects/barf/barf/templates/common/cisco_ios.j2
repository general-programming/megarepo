{% include 'common/shared_ios_common.j2' %}

{# VLANs #}
{% include 'common/shared_ios_vlans.j2' %}

{# Interfaces #}
{% include 'common/shared_ios_interfaces.j2' %}

{# TACACS #}
aaa new-model

tacacs-server key {{ device.tacacs_key }}
aaa group server tacacs consul
{% for server in device.tacacs_servers %}
    server {{ server }}
{% endfor %}
!

{% for server in device.tacacs_servers %}
tacacs-server host {{ server }}
{% endfor %}

aaa authentication login default group consul local
aaa authentication enable default group consul enable

aaa authorization exec default group consul local
aaa authorization commands 0 default group consul local
aaa authorization commands 1 default group consul local
aaa authorization commands 15 default group consul local

aaa accounting exec default start-stop group consul
aaa accounting commands 0 default start-stop group consul
aaa accounting commands 1 default start-stop group consul
aaa accounting commands 15 default start-stop group consul
